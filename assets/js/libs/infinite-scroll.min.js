/*
 Infinite Scroll PACKAGED v3.0.6
 Automatically add next page

 Licensed GPLv3 for open source use
 or Infinite Scroll Commercial License for commercial use

 https://infinite-scroll.com
 Copyright 2018 Metafizzy
 Infinite Scroll v3.0.6
 Automatically add next page

 Licensed GPLv3 for open source use
 or Infinite Scroll Commercial License for commercial use

 https://infinite-scroll.com
 Copyright 2018 Metafizzy
 imagesLoaded v4.1.4
 JavaScript is all like "You images are done yet or what?"
 MIT License
*/
(function(a,b){"function"==typeof define&&define.amd?define("jquery-bridget/jquery-bridget",["jquery"],function(e){return b(a,e)}):"object"==typeof module&&module.exports?module.exports=b(a,require("jquery")):a.jQueryBridget=b(a,a.jQuery)})(window,function(a,b){function e(c,e,k){function g(g,d,b){var a,m="$()."+c+'("'+d+'")';g.each(function(g,f){var e=k.data(f,c);if(e){var l=e[d];l&&"_"!=d.charAt(0)?(e=l.apply(e,b),a=void 0===a?e:a):h(m+" is not a valid method")}else h(c+" not initialized. Cannot call methods, i.e. "+
m)});return void 0!==a?a:g}function m(g,d){g.each(function(g,a){var b=k.data(a,c);b?(b.option(d),b._init()):(b=new e(a,d),k.data(a,c,b))})}if(k=k||b||a.jQuery)e.prototype.option||(e.prototype.option=function(g){k.isPlainObject(g)&&(this.options=k.extend(!0,this.options,g))}),k.fn[c]=function(c){if("string"==typeof c){var d=f.call(arguments,1);return g(this,c,d)}m(this,c);return this},d(k)}function d(c){!c||c&&c.bridget||(c.bridget=e)}var f=Array.prototype.slice,c=a.console,h="undefined"==typeof c?
function(){}:function(d){c.error(d)};d(b||a.jQuery);return e});
(function(a,b){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",b):"object"==typeof module&&module.exports?module.exports=b():a.EvEmitter=b()})("undefined"!=typeof window?window:this,function(){function a(){}var b=a.prototype;b.on=function(a,d){if(a&&d){var b=this._events=this._events||{},b=b[a]=b[a]||[];-1==b.indexOf(d)&&b.push(d);return this}};b.once=function(b,d){if(b&&d){this.on(b,d);var a=this._onceEvents=this._onceEvents||{};(a[b]=a[b]||{})[d]=!0;return this}};b.off=function(b,
d){var a=this._events&&this._events[b];if(a&&a.length){var c=a.indexOf(d);-1!=c&&a.splice(c,1);return this}};b.emitEvent=function(a,d){var b=this._events&&this._events[a];if(b&&b.length){b=b.slice(0);d=d||[];for(var c=this._onceEvents&&this._onceEvents[a],h=0;h<b.length;h++){var e=b[h];c&&c[e]&&(this.off(a,e),delete c[e]);e.apply(this,d)}return this}};b.allOff=function(){delete this._events;delete this._onceEvents};return a});
(function(a,b){"function"==typeof define&&define.amd?define("desandro-matches-selector/matches-selector",b):"object"==typeof module&&module.exports?module.exports=b():a.matchesSelector=b()})(window,function(){var a=function(){var b=window.Element.prototype;if(b.matches)return"matches";if(b.matchesSelector)return"matchesSelector";for(var a=["webkit","moz","ms","o"],d=0;d<a.length;d++){var f=a[d]+"MatchesSelector";if(b[f])return f}}();return function(b,e){return b[a](e)}});
(function(a,b){"function"==typeof define&&define.amd?define("fizzy-ui-utils/utils",["desandro-matches-selector/matches-selector"],function(e){return b(a,e)}):"object"==typeof module&&module.exports?module.exports=b(a,require("desandro-matches-selector")):a.fizzyUIUtils=b(a,a.matchesSelector)})(window,function(a,b){var e={extend:function(c,a){for(var b in a)c[b]=a[b];return c},modulo:function(c,a){return(c%a+a)%a}},d=Array.prototype.slice;e.makeArray=function(c){return Array.isArray(c)?c:null===c||
void 0===c?[]:"object"==typeof c&&"number"==typeof c.length?d.call(c):[c]};e.removeFrom=function(c,a){var b=c.indexOf(a);-1!=b&&c.splice(b,1)};e.getParent=function(c,a){for(;c.parentNode&&c!=document.body;)if(c=c.parentNode,b(c,a))return c};e.getQueryElement=function(c){return"string"==typeof c?document.querySelector(c):c};e.handleEvent=function(c){var a="on"+c.type;if(this[a])this[a](c)};e.filterFindElements=function(c,a){c=e.makeArray(c);var d=[];c.forEach(function(c){if(c instanceof HTMLElement)if(a){b(c,
a)&&d.push(c);c=c.querySelectorAll(a);for(var e=0;e<c.length;e++)d.push(c[e])}else d.push(c)});return d};e.debounceMethod=function(c,a,b){b=b||100;var d=c.prototype[a],e=a+"Timeout";c.prototype[a]=function(){clearTimeout(this[e]);var g=arguments,c=this;this[e]=setTimeout(function(){d.apply(c,g);delete c[e]},b)}};e.docReady=function(c){var a=document.readyState;"complete"==a||"interactive"==a?setTimeout(c):document.addEventListener("DOMContentLoaded",c)};e.toDashed=function(c){return c.replace(/(.)([A-Z])/g,
function(c,a,b){return a+"-"+b}).toLowerCase()};var f=a.console;e.htmlInit=function(c,b){e.docReady(function(){var d=e.toDashed(b),h="data-"+d,k=document.querySelectorAll("["+h+"]"),d=document.querySelectorAll(".js-"+d),k=e.makeArray(k).concat(e.makeArray(d)),g=h+"-options",m=a.jQuery;k.forEach(function(a){var d=a.getAttribute(h)||a.getAttribute(g),e;try{e=d&&JSON.parse(d)}catch(t){f&&f.error("Error parsing "+h+" on "+a.className+": "+t);return}d=new c(a,e);m&&m.data(a,b,d)})})};return e});
(function(a,b){"function"==typeof define&&define.amd?define("infinite-scroll/js/core",["ev-emitter/ev-emitter","fizzy-ui-utils/utils"],function(e,d){return b(a,e,d)}):"object"==typeof module&&module.exports?module.exports=b(a,require("ev-emitter"),require("fizzy-ui-utils")):a.InfiniteScroll=b(a,a.EvEmitter,a.fizzyUIUtils)})(window,function(a,b,e){function d(g,a){var b=e.getQueryElement(g);if(b){g=b;if(g.infiniteScrollGUID)return b=c[g.infiniteScrollGUID],b.option(a),b;this.element=g;this.options=
e.extend({},d.defaults);this.option(a);f&&(this.$element=f(this.element));this.create()}else console.error("Bad element for InfiniteScroll: "+(b||g))}var f=a.jQuery,c={};d.defaults={};d.create={};d.destroy={};var h=d.prototype;e.extend(h,b.prototype);var l=0;h.create=function(){var g=this.guid=++l;this.element.infiniteScrollGUID=g;c[g]=this;this.pageIndex=1;this.loadCount=0;this.updateGetPath();if(this.getPath&&this.getPath()){this.updateGetAbsolutePath();this.log("initialized",[this.element.className]);
this.callOnInit();for(var a in d.create)d.create[a].call(this)}else console.error("Disabling InfiniteScroll")};h.option=function(g){e.extend(this.options,g)};h.callOnInit=function(){var g=this.options.onInit;g&&g.call(this,this)};h.dispatchEvent=function(g,a,c){this.log(g,c);var b=a?[a].concat(c):c;this.emitEvent(g,b);f&&this.$element&&(b=g+=".infiniteScroll",a&&(a=f.Event(a),a.type=g,b=a),this.$element.trigger(b,c))};var n={initialized:function(a){return"on "+a},request:function(a){return"URL: "+
a},load:function(a,c){return(a.title||"")+". URL: "+c},error:function(a,c){return a+". URL: "+c},append:function(a,c,b){return b.length+" items. URL: "+c},last:function(a,c){return"URL: "+c},history:function(a,c){return"URL: "+c},pageIndex:function(a,c){return"current page determined to be: "+a+" from "+c}};h.log=function(a,c){if(this.options.debug){var b="[InfiniteScroll] "+a,g=n[a];g&&(b+=". "+g.apply(this,c));console.log(b)}};h.updateMeasurements=function(){this.windowHeight=a.innerHeight;this.top=
this.element.getBoundingClientRect().top+a.pageYOffset};h.updateScroller=function(){var c=this.options.elementScroll;if(c){if(this.scroller=!0===c?this.element:e.getQueryElement(c),!this.scroller)throw"Unable to find elementScroll: "+c;}else this.scroller=a};h.updateGetPath=function(){var a=this.options.path;if(a){var c=typeof a;"function"==c?this.getPath=a:"string"==c&&a.match("{{#}}")?this.updateGetPathTemplate(a):this.updateGetPathSelector(a)}else console.error("InfiniteScroll path option required. Set as: "+
a)};h.updateGetPathTemplate=function(a){this.getPath=function(){return a.replace("{{#}}",this.pageIndex+1)}.bind(this);var c=a.replace(/(\\\?|\?)/,"\\?").replace("{{#}}","(\\d\\d?\\d?)");if(c=location.href.match(new RegExp(c)))this.pageIndex=parseInt(c[1],10),this.log("pageIndex",[this.pageIndex,"template string"])};var k=[/^(.*?\/?page\/?)(\d\d?\d?)(.*?$)/,/^(.*?\/?\?page=)(\d\d?\d?)(.*?$)/,/(.*?)(\d\d?\d?)(?!.*\d)(.*?$)/];h.updateGetPathSelector=function(a){var c=document.querySelector(a);if(c){a=
c.getAttribute("href");for(var b,d,c=0;a&&c<k.length;c++)if(d=k[c],d=a.match(d)){b=d.slice(1);break}b?(this.isPathSelector=!0,this.getPath=function(){return b[0]+(this.pageIndex+1)+b[2]}.bind(this),this.pageIndex=parseInt(b[1],10)-1,this.log("pageIndex",[this.pageIndex,"next link"])):console.error("InfiniteScroll unable to parse next link href: "+a)}else console.error("Bad InfiniteScroll path option. Next link not found: "+a)};h.updateGetAbsolutePath=function(){var a=this.getPath();if(a.match(/^http/)||
a.match(/^\//))this.getAbsolutePath=this.getPath;else{var c=location.pathname;if(a.match(/^\?/))this.getAbsolutePath=function(){return c+this.getPath()};else{var b=c.substring(0,c.lastIndexOf("/"));this.getAbsolutePath=function(){return b+"/"+this.getPath()}}}};d.create.hideNav=function(){var a=e.getQueryElement(this.options.hideNav);a&&(a.style.display="none",this.nav=a)};d.destroy.hideNav=function(){this.nav&&(this.nav.style.display="")};h.destroy=function(){this.allOff();for(var a in d.destroy)d.destroy[a].call(this);
delete this.element.infiniteScrollGUID;delete c[this.guid];f&&this.$element&&f.removeData(this.element,"infiniteScroll")};d.throttle=function(a,c){c=c||200;var b,d;return function(){var g=+new Date,e=arguments,f=function(){b=g;a.apply(this,e)}.bind(this);b&&g<b+c?(clearTimeout(d),d=setTimeout(f,c)):f()}};d.data=function(a){return(a=(a=e.getQueryElement(a))&&a.infiniteScrollGUID)&&c[a]};d.setJQuery=function(a){f=a};e.htmlInit(d,"infinite-scroll");h._init=function(){};f&&f.bridget&&f.bridget("infiniteScroll",
d);return d});
(function(a,b){"function"==typeof define&&define.amd?define("infinite-scroll/js/page-load",["./core"],function(e){return b(a,e)}):"object"==typeof module&&module.exports?module.exports=b(a,require("./core")):b(a,a.InfiniteScroll)})(window,function(a,b){function e(a){for(var c=document.createDocumentFragment(),b=0;a&&b<a.length;b++)c.appendChild(a[b]);return c}function d(a,b,d,e,f){var c=new XMLHttpRequest;c.open("GET",a,!0);c.responseType=b||"";c.setRequestHeader("X-Requested-With","XMLHttpRequest");
c.onload=function(){200==c.status?d(c.response):204==c.status?f(c.response):e(Error(c.statusText))};c.onerror=function(){e(Error("Network error requesting "+a))};c.send()}var f=b.prototype;b.defaults.loadOnScroll=!0;b.defaults.checkLastPage=!0;b.defaults.responseType="document";b.create.pageLoad=function(){this.canLoad=!0;this.on("scrollThreshold",this.onScrollThresholdLoad);this.on("load",this.checkLastPage);if(this.options.outlayer)this.on("append",this.onAppendOutlayer)};f.onScrollThresholdLoad=
function(){this.options.loadOnScroll&&this.loadNextPage()};f.loadNextPage=function(){if(!this.isLoading&&this.canLoad){var a=this.getAbsolutePath();this.isLoading=!0;var b=function(c){this.onPageLoad(c,a)}.bind(this),e=function(c){this.onPageError(c,a)}.bind(this),f=function(c){this.lastPageReached(c,a)}.bind(this);d(a,this.options.responseType,b,e,f);this.dispatchEvent("request",null,[a])}};f.onPageLoad=function(a,b){this.options.append||(this.isLoading=!1);this.pageIndex++;this.loadCount++;this.dispatchEvent("load",
null,[a,b]);this.appendNextPage(a,b);return a};f.appendNextPage=function(a,b){var c=this.options.append;if("document"==this.options.responseType&&c){var d=a.querySelectorAll(c),f=e(d),c=function(){this.appendItems(d,f);this.isLoading=!1;this.dispatchEvent("append",null,[a,b,d])}.bind(this);this.options.outlayer?this.appendOutlayerItems(f,c):c()}};f.appendItems=function(a,b){if(a&&a.length){b=b||e(a);for(var c=b.querySelectorAll("script"),d=0;d<c.length;d++){for(var f=c[d],g=document.createElement("script"),
h=g,q=f.attributes,p=0;p<q.length;p++){var r=q[p];h.setAttribute(r.name,r.value)}g.innerHTML=f.innerHTML;f.parentNode.replaceChild(g,f)}this.element.appendChild(b)}};f.appendOutlayerItems=function(c,d){var e=b.imagesLoaded||a.imagesLoaded;e?e(c,d):(console.error("[InfiniteScroll] imagesLoaded required for outlayer option"),this.isLoading=!1)};f.onAppendOutlayer=function(a,b,d){this.options.outlayer.appended(d)};f.checkLastPage=function(a,b){var c=this.options.checkLastPage;if(c){var d=this.options.path;
if("function"!=typeof d||this.getPath()){var e;"string"==typeof c?e=c:this.isPathSelector&&(e=d);e&&a.querySelector&&(a.querySelector(e)||this.lastPageReached(a,b))}else this.lastPageReached(a,b)}};f.lastPageReached=function(a,b){this.canLoad=!1;this.dispatchEvent("last",null,[a,b])};f.onPageError=function(a,b){this.canLoad=this.isLoading=!1;this.dispatchEvent("error",null,[a,b]);return a};b.create.prefill=function(){if(this.options.prefill){var a=this.options.append;a?(this.updateMeasurements(),
this.updateScroller(),this.isPrefilling=!0,this.on("append",this.prefill),this.once("error",this.stopPrefill),this.once("last",this.stopPrefill),this.prefill()):console.error("append option required for prefill. Set as :"+a)}};f.prefill=function(){(this.isPrefilling=0<=this.getPrefillDistance())?(this.log("prefill"),this.loadNextPage()):this.stopPrefill()};f.getPrefillDistance=function(){return this.options.elementScroll?this.scroller.clientHeight-this.scroller.scrollHeight:this.windowHeight-this.element.clientHeight};
f.stopPrefill=function(){this.log("stopPrefill");this.off("append",this.prefill)};return b});
(function(a,b){"function"==typeof define&&define.amd?define("infinite-scroll/js/scroll-watch",["./core","fizzy-ui-utils/utils"],function(e,d){return b(a,e,d)}):"object"==typeof module&&module.exports?module.exports=b(a,require("./core"),require("fizzy-ui-utils")):b(a,a.InfiniteScroll,a.fizzyUIUtils)})(window,function(a,b,e){var d=b.prototype;b.defaults.scrollThreshold=400;b.create.scrollWatch=function(){this.pageScrollHandler=this.onPageScroll.bind(this);this.resizeHandler=this.onResize.bind(this);
var a=this.options.scrollThreshold;(a||0===a)&&this.enableScrollWatch()};b.destroy.scrollWatch=function(){this.disableScrollWatch()};d.enableScrollWatch=function(){this.isScrollWatching||(this.isScrollWatching=!0,this.updateMeasurements(),this.updateScroller(),this.on("last",this.disableScrollWatch),this.bindScrollWatchEvents(!0))};d.disableScrollWatch=function(){this.isScrollWatching&&(this.bindScrollWatchEvents(!1),delete this.isScrollWatching)};d.bindScrollWatchEvents=function(b){b=b?"addEventListener":
"removeEventListener";this.scroller[b]("scroll",this.pageScrollHandler);a[b]("resize",this.resizeHandler)};d.onPageScroll=b.throttle(function(){this.getBottomDistance()<=this.options.scrollThreshold&&this.dispatchEvent("scrollThreshold")});d.getBottomDistance=function(){return this.options.elementScroll?this.getElementBottomDistance():this.getWindowBottomDistance()};d.getWindowBottomDistance=function(){return this.top+this.element.clientHeight-(a.pageYOffset+this.windowHeight)};d.getElementBottomDistance=
function(){return this.scroller.scrollHeight-(this.scroller.scrollTop+this.scroller.clientHeight)};d.onResize=function(){this.updateMeasurements()};e.debounceMethod(b,"onResize",150);return b});
(function(a,b){"function"==typeof define&&define.amd?define("infinite-scroll/js/history",["./core","fizzy-ui-utils/utils"],function(e,d){return b(a,e,d)}):"object"==typeof module&&module.exports?module.exports=b(a,require("./core"),require("fizzy-ui-utils")):b(a,a.InfiniteScroll,a.fizzyUIUtils)})(window,function(a,b,e){var d=b.prototype;b.defaults.history="replace";var f=document.createElement("a");b.create.history=function(){this.options.history&&(f.href=this.getAbsolutePath(),(f.origin||f.protocol+
"//"+f.host)!=location.origin?console.error("[InfiniteScroll] cannot set history with different origin: "+f.origin+" on "+location.origin+" . History behavior disabled."):this.options.append?this.createHistoryAppend():this.createHistoryPageLoad())};d.createHistoryAppend=function(){this.updateMeasurements();this.updateScroller();this.scrollPages=[{top:0,path:location.href,title:document.title}];this.scrollPageIndex=0;this.scrollHistoryHandler=this.onScrollHistory.bind(this);this.unloadHandler=this.onUnload.bind(this);
this.scroller.addEventListener("scroll",this.scrollHistoryHandler);this.on("append",this.onAppendHistory);this.bindHistoryAppendEvents(!0)};d.bindHistoryAppendEvents=function(c){c=c?"addEventListener":"removeEventListener";this.scroller[c]("scroll",this.scrollHistoryHandler);a[c]("unload",this.unloadHandler)};d.createHistoryPageLoad=function(){this.on("load",this.onPageLoadHistory)};b.destroy.history=d.destroyHistory=function(){this.options.history&&this.options.append&&this.bindHistoryAppendEvents(!1)};
d.onAppendHistory=function(a,b,d){d&&d.length&&(d=this.getElementScrollY(d[0]),f.href=b,this.scrollPages.push({top:d,path:f.href,title:a.title}))};d.getElementScrollY=function(a){return this.options.elementScroll?this.getElementElementScrollY(a):this.getElementWindowScrollY(a)};d.getElementWindowScrollY=function(b){return b.getBoundingClientRect().top+a.pageYOffset};d.getElementElementScrollY=function(a){return a.offsetTop-this.top};d.onScrollHistory=function(){for(var a=this.getScrollViewY(),b,d,
e=0;e<this.scrollPages.length;e++){var f=this.scrollPages[e];if(f.top>=a)break;b=e;d=f}b!=this.scrollPageIndex&&(this.scrollPageIndex=b,this.setHistory(d.title,d.path))};e.debounceMethod(b,"onScrollHistory",150);d.getScrollViewY=function(){return this.options.elementScroll?this.scroller.scrollTop+this.scroller.clientHeight/2:a.pageYOffset+this.windowHeight/2};d.setHistory=function(a,b){var c=this.options.history;c&&history[c+"State"]&&(history[c+"State"](null,a,b),this.options.historyTitle&&(document.title=
a),this.dispatchEvent("history",null,[a,b]))};d.onUnload=function(){var b=this.scrollPageIndex;0!==b&&(b=a.pageYOffset-this.scrollPages[b].top+this.top,this.destroyHistory(),scrollTo(0,b))};d.onPageLoadHistory=function(a,b){this.setHistory(a.title,b)};return b});
(function(a,b){"function"==typeof define&&define.amd?define("infinite-scroll/js/button",["./core","fizzy-ui-utils/utils"],function(e,d){return b(a,e,d)}):"object"==typeof module&&module.exports?module.exports=b(a,require("./core"),require("fizzy-ui-utils")):b(a,a.InfiniteScroll,a.fizzyUIUtils)})(window,function(a,b,e){function d(a,b){this.element=a;this.infScroll=b;this.clickHandler=this.onClick.bind(this);this.element.addEventListener("click",this.clickHandler);b.on("request",this.disable.bind(this));
b.on("load",this.enable.bind(this));b.on("error",this.hide.bind(this));b.on("last",this.hide.bind(this))}b.create.button=function(){var a=e.getQueryElement(this.options.button);a&&(this.button=new d(a,this))};b.destroy.button=function(){this.button&&this.button.destroy()};d.prototype.onClick=function(a){a.preventDefault();this.infScroll.loadNextPage()};d.prototype.enable=function(){this.element.removeAttribute("disabled")};d.prototype.disable=function(){this.element.disabled="disabled"};d.prototype.hide=
function(){this.element.style.display="none"};d.prototype.destroy=function(){this.element.removeEventListener("click",this.clickHandler)};b.Button=d;return b});
(function(a,b){"function"==typeof define&&define.amd?define("infinite-scroll/js/status",["./core","fizzy-ui-utils/utils"],function(e,d){return b(a,e,d)}):"object"==typeof module&&module.exports?module.exports=b(a,require("./core"),require("fizzy-ui-utils")):b(a,a.InfiniteScroll,a.fizzyUIUtils)})(window,function(a,b,e){a=b.prototype;b.create.status=function(){var a=e.getQueryElement(this.options.status);a&&(this.statusElement=a,this.statusEventElements={request:a.querySelector(".infinite-scroll-request"),
error:a.querySelector(".infinite-scroll-error"),last:a.querySelector(".infinite-scroll-last")},this.on("request",this.showRequestStatus),this.on("error",this.showErrorStatus),this.on("last",this.showLastStatus),this.bindHideStatus("on"))};a.bindHideStatus=function(a){this[a](this.options.append?"append":"load",this.hideAllStatus)};a.showRequestStatus=function(){this.showStatus("request")};a.showErrorStatus=function(){this.showStatus("error")};a.showLastStatus=function(){this.showStatus("last");this.bindHideStatus("off")};
a.showStatus=function(a){var b=this.statusElement;b&&(b.style.display="block");this.hideStatusEventElements();if(a=this.statusEventElements[a])a.style.display="block"};a.hideAllStatus=function(){var a=this.statusElement;a&&(a.style.display="none");this.hideStatusEventElements()};a.hideStatusEventElements=function(){for(var a in this.statusEventElements){var b=this.statusEventElements[a];b&&(b.style.display="none")}};return b});
(function(a,b){"function"==typeof define&&define.amd?define("infinite-scroll/js/core infinite-scroll/js/page-load infinite-scroll/js/scroll-watch infinite-scroll/js/history infinite-scroll/js/button infinite-scroll/js/status".split(" "),b):"object"==typeof module&&module.exports&&(module.exports=b(require("./core"),require("./page-load"),require("./scroll-watch"),require("./history"),require("./button"),require("./status")))})(window,function(a){return a});
(function(a,b){"function"==typeof define&&define.amd?define("imagesloaded/imagesloaded",["ev-emitter/ev-emitter"],function(e){return b(a,e)}):"object"==typeof module&&module.exports?module.exports=b(a,require("ev-emitter")):a.imagesLoaded=b(a,a.EvEmitter)})("undefined"!==typeof window?window:this,function(a,b){function e(a,b){for(var c in b)a[c]=b[c];return a}function d(a,b,c){if(!(this instanceof d))return new d(a,b,c);var g=a;"string"==typeof a&&(g=document.querySelectorAll(a));if(g){a=g;a=Array.isArray(a)?
a:"object"==typeof a&&"number"==typeof a.length?n.call(a):[a];this.elements=a;this.options=e({},this.options);"function"==typeof b?c=b:e(this.options,b);if(c)this.on("always",c);this.getImages();h&&(this.jqDeferred=new h.Deferred);setTimeout(this.check.bind(this))}else l.error("Bad element for imagesLoaded "+(g||a))}function f(a){this.img=a}function c(a,b){this.url=a;this.element=b;this.img=new Image}var h=a.jQuery,l=a.console,n=Array.prototype.slice;d.prototype=Object.create(b.prototype);d.prototype.options=
{};d.prototype.getImages=function(){this.images=[];this.elements.forEach(this.addElementImages,this)};d.prototype.addElementImages=function(a){"IMG"==a.nodeName&&this.addImage(a);!0===this.options.background&&this.addElementBackgroundImages(a);var b=a.nodeType;if(b&&k[b]){for(var c=a.querySelectorAll("img"),b=0;b<c.length;b++)this.addImage(c[b]);if("string"==typeof this.options.background)for(a=a.querySelectorAll(this.options.background),b=0;b<a.length;b++)this.addElementBackgroundImages(a[b])}};
var k={1:!0,9:!0,11:!0};d.prototype.addElementBackgroundImages=function(a){var b=getComputedStyle(a);if(b)for(var c=/url\((['"])?(.*?)\1\)/gi,d=c.exec(b.backgroundImage);null!==d;)(d=d&&d[2])&&this.addBackground(d,a),d=c.exec(b.backgroundImage)};d.prototype.addImage=function(a){a=new f(a);this.images.push(a)};d.prototype.addBackground=function(a,b){var d=new c(a,b);this.images.push(d)};d.prototype.check=function(){function a(a,c,d){setTimeout(function(){b.progress(a,c,d)})}var b=this;this.progressedCount=
0;this.hasAnyBroken=!1;this.images.length?this.images.forEach(function(b){b.once("progress",a);b.check()}):this.complete()};d.prototype.progress=function(a,b,c){this.progressedCount++;this.hasAnyBroken=this.hasAnyBroken||!a.isLoaded;this.emitEvent("progress",[this,a,b]);this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,a);this.progressedCount==this.images.length&&this.complete();this.options.debug&&l&&l.log("progress: "+c,a,b)};d.prototype.complete=function(){var a=this.hasAnyBroken?
"fail":"done";this.isComplete=!0;this.emitEvent(a,[this]);this.emitEvent("always",[this]);if(this.jqDeferred)this.jqDeferred[this.hasAnyBroken?"reject":"resolve"](this)};f.prototype=Object.create(b.prototype);f.prototype.check=function(){this.getIsImageComplete()?this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",
this),this.proxyImage.src=this.img.src)};f.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth};f.prototype.confirm=function(a,b){this.isLoaded=a;this.emitEvent("progress",[this,this.img,b])};f.prototype.handleEvent=function(a){var b="on"+a.type;if(this[b])this[b](a)};f.prototype.onload=function(){this.confirm(!0,"onload");this.unbindEvents()};f.prototype.onerror=function(){this.confirm(!1,"onerror");this.unbindEvents()};f.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",
this);this.proxyImage.removeEventListener("error",this);this.img.removeEventListener("load",this);this.img.removeEventListener("error",this)};c.prototype=Object.create(f.prototype);c.prototype.check=function(){this.img.addEventListener("load",this);this.img.addEventListener("error",this);this.img.src=this.url;this.getIsImageComplete()&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())};c.prototype.unbindEvents=function(){this.img.removeEventListener("load",this);this.img.removeEventListener("error",
this)};c.prototype.confirm=function(a,b){this.isLoaded=a;this.emitEvent("progress",[this,this.element,b])};d.makeJQueryPlugin=function(b){if(b=b||a.jQuery)h=b,h.fn.imagesLoaded=function(a,b){return(new d(this,a,b)).jqDeferred.promise(h(this))}};d.makeJQueryPlugin();return d});
